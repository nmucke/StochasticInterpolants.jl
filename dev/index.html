<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · StochasticInterpolants.jl</title><meta name="title" content="Home · StochasticInterpolants.jl"/><meta property="og:title" content="Home · StochasticInterpolants.jl"/><meta property="twitter:title" content="Home · StochasticInterpolants.jl"/><meta name="description" content="Documentation for StochasticInterpolants.jl."/><meta property="og:description" content="Documentation for StochasticInterpolants.jl."/><meta property="twitter:description" content="Documentation for StochasticInterpolants.jl."/><meta property="og:url" content="https://nmucke.github.io/StochasticInterpolants.jl/"/><meta property="twitter:url" content="https://nmucke.github.io/StochasticInterpolants.jl/"/><link rel="canonical" href="https://nmucke.github.io/StochasticInterpolants.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>StochasticInterpolants.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nmucke/StochasticInterpolants.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="StochasticInterpolants"><a class="docs-heading-anchor" href="#StochasticInterpolants">StochasticInterpolants</a><a id="StochasticInterpolants-1"></a><a class="docs-heading-anchor-permalink" href="#StochasticInterpolants" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/nmucke/StochasticInterpolants.jl">StochasticInterpolants</a>.</p><ul><li><a href="#StochasticInterpolants.StochasticInterpolants"><code>StochasticInterpolants.StochasticInterpolants</code></a></li><li><a href="#StochasticInterpolants.AttnParsConvNextUNet"><code>StochasticInterpolants.AttnParsConvNextUNet</code></a></li><li><a href="#StochasticInterpolants.Autoencoder"><code>StochasticInterpolants.Autoencoder</code></a></li><li><a href="#StochasticInterpolants.ConditionalDiffusionTransformer"><code>StochasticInterpolants.ConditionalDiffusionTransformer</code></a></li><li><a href="#StochasticInterpolants.ConditionalTransformerUNet"><code>StochasticInterpolants.ConditionalTransformerUNet</code></a></li><li><a href="#StochasticInterpolants.ConvNextUNetNoPars"><code>StochasticInterpolants.ConvNextUNetNoPars</code></a></li><li><a href="#StochasticInterpolants.ConvNextUNetWithPars"><code>StochasticInterpolants.ConvNextUNetWithPars</code></a></li><li><a href="#StochasticInterpolants.DataDependentCouplingStochasticInterpolant"><code>StochasticInterpolants.DataDependentCouplingStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.DataDependentCouplingStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.DataDependentCouplingStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.DataDependentCouplingStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.DataDependentCouplingStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.DenoisingDiffusionProbabilisticModel"><code>StochasticInterpolants.DenoisingDiffusionProbabilisticModel</code></a></li><li><a href="#StochasticInterpolants.DiffusionTransformer"><code>StochasticInterpolants.DiffusionTransformer</code></a></li><li><a href="#StochasticInterpolants.DiffusionTransformerBlock"><code>StochasticInterpolants.DiffusionTransformerBlock</code></a></li><li><a href="#StochasticInterpolants.EncoderFollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer, NamedTuple}"><code>StochasticInterpolants.EncoderFollmerStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.EncoderFollmerStochasticInterpolant"><code>StochasticInterpolants.EncoderFollmerStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.EntropicActionMatching"><code>StochasticInterpolants.EntropicActionMatching</code></a></li><li><a href="#StochasticInterpolants.EntropicActionMatching-Tuple{LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.EntropicActionMatching</code></a></li><li><a href="#StochasticInterpolants.FollmerStochasticInterpolant"><code>StochasticInterpolants.FollmerStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.FollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.FollmerStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.LatentFollmerStochasticInterpolant"><code>StochasticInterpolants.LatentFollmerStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.LatentFollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, VAE_wrapper}"><code>StochasticInterpolants.LatentFollmerStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.NoiseScheduling"><code>StochasticInterpolants.NoiseScheduling</code></a></li><li><a href="#StochasticInterpolants.NormalizePars"><code>StochasticInterpolants.NormalizePars</code></a></li><li><a href="#StochasticInterpolants.PhysicsInformedStochasticInterpolant"><code>StochasticInterpolants.PhysicsInformedStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.PhysicsInformedStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, Function}"><code>StochasticInterpolants.PhysicsInformedStochasticInterpolant</code></a></li><li><a href="#StochasticInterpolants.PositionEncoding"><code>StochasticInterpolants.PositionEncoding</code></a></li><li><a href="#StochasticInterpolants.ScoreMatchingLangevinDynamics"><code>StochasticInterpolants.ScoreMatchingLangevinDynamics</code></a></li><li><a href="#StochasticInterpolants.StandardizeData"><code>StochasticInterpolants.StandardizeData</code></a></li><li><a href="#StochasticInterpolants.StochasticInterpolantModel-Tuple{Tuple{Int64, Int64}}"><code>StochasticInterpolants.StochasticInterpolantModel</code></a></li><li><a href="#StochasticInterpolants.StochasticInterpolantModel"><code>StochasticInterpolants.StochasticInterpolantModel</code></a></li><li><a href="#StochasticInterpolants.ViPosEmbedding"><code>StochasticInterpolants.ViPosEmbedding</code></a></li><li><a href="#StochasticInterpolants.CheckpointManager-Tuple{String, String}"><code>StochasticInterpolants.CheckpointManager</code></a></li><li><a href="#StochasticInterpolants.Interpolant"><code>StochasticInterpolants.Interpolant</code></a></li><li><a href="#StochasticInterpolants.LinearMultiHeadSelfAttention-Union{Tuple{Int64, Int64}, Tuple{T}} where T"><code>StochasticInterpolants.LinearMultiHeadSelfAttention</code></a></li><li><a href="#StochasticInterpolants.MultiHeadSelfAttention-Union{Tuple{Int64, Int64}, Tuple{T}} where T"><code>StochasticInterpolants.MultiHeadSelfAttention</code></a></li><li><a href="#StochasticInterpolants.VisionTransformerEncoder-Tuple{Any, Any, Any}"><code>StochasticInterpolants.VisionTransformerEncoder</code></a></li><li><a href="#StochasticInterpolants._fast_chunk-Tuple{Int64, Int64}"><code>StochasticInterpolants._fast_chunk</code></a></li><li><a href="#StochasticInterpolants._flatten_spatial-Union{Tuple{AbstractArray{T, 4}}, Tuple{T}} where T"><code>StochasticInterpolants._flatten_spatial</code></a></li><li><a href="#StochasticInterpolants.conv_next_block-Tuple{}"><code>StochasticInterpolants.conv_next_block</code></a></li><li><a href="#StochasticInterpolants.conv_next_block_no_pars-Tuple{}"><code>StochasticInterpolants.conv_next_block_no_pars</code></a></li><li><a href="#StochasticInterpolants.create_checkpoint_directory-Tuple{String, String}"><code>StochasticInterpolants.create_checkpoint_directory</code></a></li><li><a href="#StochasticInterpolants.euler_maruyama_sampler"><code>StochasticInterpolants.euler_maruyama_sampler</code></a></li><li><a href="#StochasticInterpolants.forward_diffusion_sample"><code>StochasticInterpolants.forward_diffusion_sample</code></a></li><li><a href="#StochasticInterpolants.get_beta_schedule-Tuple{Int64}"><code>StochasticInterpolants.get_beta_schedule</code></a></li><li><a href="#StochasticInterpolants.get_encoder_forecasting_loss"><code>StochasticInterpolants.get_encoder_forecasting_loss</code></a></li><li><a href="#StochasticInterpolants.get_forecasting_from_gaussian_loss"><code>StochasticInterpolants.get_forecasting_from_gaussian_loss</code></a></li><li><a href="#StochasticInterpolants.get_forecasting_loss"><code>StochasticInterpolants.get_forecasting_loss</code></a></li><li><a href="#StochasticInterpolants.get_forecasting_loss"><code>StochasticInterpolants.get_forecasting_loss</code></a></li><li><a href="#StochasticInterpolants.get_loss"><code>StochasticInterpolants.get_loss</code></a></li><li><a href="#StochasticInterpolants.get_loss"><code>StochasticInterpolants.get_loss</code></a></li><li><a href="#StochasticInterpolants.get_loss"><code>StochasticInterpolants.get_loss</code></a></li><li><a href="#StochasticInterpolants.get_physics_forecasting_loss"><code>StochasticInterpolants.get_physics_forecasting_loss</code></a></li><li><a href="#StochasticInterpolants.get_t_pars_embedding"><code>StochasticInterpolants.get_t_pars_embedding</code></a></li><li><a href="#StochasticInterpolants.load_model_config-Tuple{String}"><code>StochasticInterpolants.load_model_config</code></a></li><li><a href="#StochasticInterpolants.load_model_weights-Tuple{String}"><code>StochasticInterpolants.load_model_weights</code></a></li><li><a href="#StochasticInterpolants.multiple_conv_next_blocks-Tuple{}"><code>StochasticInterpolants.multiple_conv_next_blocks</code></a></li><li><a href="#StochasticInterpolants.multiple_conv_next_blocks_no_pars-Tuple{}"><code>StochasticInterpolants.multiple_conv_next_blocks_no_pars</code></a></li><li><a href="#StochasticInterpolants.parameter_diffusion_transformer_block-Tuple{}"><code>StochasticInterpolants.parameter_diffusion_transformer_block</code></a></li><li><a href="#StochasticInterpolants.patchify-Tuple{Tuple{Int64, Int64}}"><code>StochasticInterpolants.patchify</code></a></li><li><a href="#StochasticInterpolants.sample_timestep-Tuple{AbstractArray, AbstractArray}"><code>StochasticInterpolants.sample_timestep</code></a></li><li><a href="#StochasticInterpolants.save_checkpoint-Tuple{}"><code>StochasticInterpolants.save_checkpoint</code></a></li><li><a href="#StochasticInterpolants.sinusoidal_embedding"><code>StochasticInterpolants.sinusoidal_embedding</code></a></li><li><a href="#StochasticInterpolants.train_diffusion_model"><code>StochasticInterpolants.train_diffusion_model</code></a></li><li><a href="#StochasticInterpolants.train_stochastic_interpolant-Tuple{}"><code>StochasticInterpolants.train_stochastic_interpolant</code></a></li><li><a href="#StochasticInterpolants.train_stochastic_interpolant"><code>StochasticInterpolants.train_stochastic_interpolant</code></a></li><li><a href="#StochasticInterpolants.train_stochastic_interpolant_for_closure-Tuple{}"><code>StochasticInterpolants.train_stochastic_interpolant_for_closure</code></a></li><li><a href="#StochasticInterpolants.unpatchify-NTuple{4, Any}"><code>StochasticInterpolants.unpatchify</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.StochasticInterpolants" href="#StochasticInterpolants.StochasticInterpolants"><code>StochasticInterpolants.StochasticInterpolants</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StochasticInterpolants</code></pre><p>Implementation of the Stochastic Interpolants method for generative modeling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/StochasticInterpolants.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.AttnParsConvNextUNet" href="#StochasticInterpolants.AttnParsConvNextUNet"><code>StochasticInterpolants.AttnParsConvNextUNet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>AttnParsConvNextUNet(         image<em>size::Tuple{Int, Int},         channels::Vector{Int} = [32, 64, 96, 128],         block</em>depth::Int = 2,         min<em>freq::Float32 = 1.0f0,         max</em>freq::Float32 = 1000.0f0,         embedding_dims::Int = 32     )</p><p>Create a conditional U-Net model with the given image size, number of channels, block depth, frequency range, and embedding dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L737-L749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.Autoencoder" href="#StochasticInterpolants.Autoencoder"><code>StochasticInterpolants.Autoencoder</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Autoencoder(in_channels::Int = 3, channels=[32, 64, 128], padding=&quot;periodic&quot;)</code></pre><p>Create an autoencoder model with the given number of input channels, output channels, and padding type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/autoencoder.jl#L123-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.ConditionalDiffusionTransformer" href="#StochasticInterpolants.ConditionalDiffusionTransformer"><code>StochasticInterpolants.ConditionalDiffusionTransformer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>ConditionalDiffusionTransformer(     imsize::Dims{2}=(256, 256),     in<em>channels::Int=3,     patch</em>size::Dims{2}=(16, 16),     embed<em>planes::Int=768,     depth::Int=6,     number</em>heads=16,     mlp<em>ratio=4.0f0,     dropout</em>rate=0.1f0,     embedding<em>dropout</em>rate=0.1f0,     pool::Symbol=:class,     num_classes::Int=1000,     kwargs... )</p><p>Create a DiffusionTransformer Transformer model with the given image size, number of input channels, patch size, embedding planes, depth, number of heads, MLP ratio, dropout rate, embedding dropout rate, pooling method, number of classes, and additional keyword arguments.</p><p>Based on https://github.com/LuxDL/Boltz.jl/blob/v0.3.9/src/vision/vit.jl#L48-L61 The architecture is based on https://arxiv.org/abs/2212.09748</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/diffusion_transformer.jl#L11-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.ConditionalTransformerUNet" href="#StochasticInterpolants.ConditionalTransformerUNet"><code>StochasticInterpolants.ConditionalTransformerUNet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConditionalTransformerUNet(
    image_size::Tuple{Int, Int},
    channels::Vector{Int} = [32, 64, 96, 128],
    block_depth::Int = 2,
    min_freq::Float32 = 1.0f0,
    max_freq::Float32 = 1000.0f0,
    embedding_dims::Int = 32
)</code></pre><p>Create a conditional U-Net model with the given image size, number of channels, block depth, frequency range, and embedding dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/unet_transformer.jl#L83-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.ConvNextUNetNoPars" href="#StochasticInterpolants.ConvNextUNetNoPars"><code>StochasticInterpolants.ConvNextUNetNoPars</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>ConvNextUNetNoPars(         image<em>size::Tuple{Int, Int},         channels::Vector{Int} = [32, 64, 96, 128],         block</em>depth::Int = 2,         min<em>freq::Float32 = 1.0f0,         max</em>freq::Float32 = 1000.0f0,     )</p><p>Create a conditional U-Net model with the given image size, number of channels, block depth, frequency range, and embedding dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L460-L471">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.ConvNextUNetWithPars" href="#StochasticInterpolants.ConvNextUNetWithPars"><code>StochasticInterpolants.ConvNextUNetWithPars</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>ConvNextUNetWithPars(         image<em>size::Tuple{Int, Int},         channels::Vector{Int} = [32, 64, 96, 128],         block</em>depth::Int = 2,         min<em>freq::Float32 = 1.0f0,         max</em>freq::Float32 = 1000.0f0,         embedding_dims::Int = 32     )</p><p>Create a conditional U-Net model with the given image size, number of channels, block depth, frequency range, and embedding dimensions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L209-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.DataDependentCouplingStochasticInterpolant" href="#StochasticInterpolants.DataDependentCouplingStochasticInterpolant"><code>StochasticInterpolants.DataDependentCouplingStochasticInterpolant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DataDependentCouplingStochasticInterpolant(
    velocity::Lux.AbstractExplicitLayer
    score::Lux.AbstractExplicitLayer

)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L384-L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.DataDependentCouplingStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer}" href="#StochasticInterpolants.DataDependentCouplingStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.DataDependentCouplingStochasticInterpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>DataDependentCouplingStochasticInterpolant(         velocity::Lux.AbstractExplicitLayer;          interpolant=Interpolant(),         gamma=Gamma(),         diffusion<em>coefficient=DiffusionCoefficient(),         diffusion</em>multiplier=0.1f0,         dev=gpu_device()      interpolant::Interpolant     )</p><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L498-L510">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.DataDependentCouplingStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer}" href="#StochasticInterpolants.DataDependentCouplingStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.DataDependentCouplingStochasticInterpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DataDependentCouplingStochasticInterpolant(
    velocity::Lux.AbstractExplicitLayer; 
    interpolant=Interpolant(),
    diffusion_multiplier=0.1f0,
    dev=gpu_device() 
)</code></pre><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L408-L417">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.DenoisingDiffusionProbabilisticModel" href="#StochasticInterpolants.DenoisingDiffusionProbabilisticModel"><code>StochasticInterpolants.DenoisingDiffusionProbabilisticModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DenoisingDiffusionProbabilisticModel(
    image_size::Tuple{Int, Int}; 
    in_channels::Int = 3,
    channels=[32, 64, 96, 128], 
    block_depth=2,
    min_freq=1.0f0, 
    max_freq=1000.0f0, 
    embedding_dims=32,
    timesteps::Int=100,
    init_beta::AbstractFloat=0.0001, 
    final_beta::AbstractFloat=0.02,
    type::String=&quot;linear&quot;
)</code></pre><p>Creates a Denoising Diffusion Probabilistic Model (DDPM) with a UNet architecture.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/DDPM/models.jl#L9-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.DiffusionTransformer" href="#StochasticInterpolants.DiffusionTransformer"><code>StochasticInterpolants.DiffusionTransformer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiffusionTransformer(
    imsize::Dims{2}=(256, 256),
    in_channels::Int=3,
    patch_size::Dims{2}=(16, 16),
    embed_planes::Int=768,
    depth::Int=6,
    number_heads=16,
    mlp_ratio=4.0f0,
    dropout_rate=0.1f0,
    embedding_dropout_rate=0.1f0,
    pool::Symbol=:class,
    num_classes::Int=1000,
    kwargs...
)</code></pre><p>Create a DiffusionTransformer Transformer model with the given image size, number of input channels, patch size, embedding planes, depth, number of heads, MLP ratio, dropout rate, embedding dropout rate, pooling method, number of classes, and additional keyword arguments.</p><p>Based on https://github.com/LuxDL/Boltz.jl/blob/v0.3.9/src/vision/vit.jl#L48-L61 The architecture is based on https://arxiv.org/abs/2212.09748</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/diffusion_transformer.jl#L386-L409">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.DiffusionTransformerBlock" href="#StochasticInterpolants.DiffusionTransformerBlock"><code>StochasticInterpolants.DiffusionTransformerBlock</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiffusionTransformerBlock(
    in_channels::Int, 
    out_channels::Int,
    block_depth::Int
)</code></pre><p>Create a diffusion transformer block</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/diffusion_transformer.jl#L233-L241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.EncoderFollmerStochasticInterpolant" href="#StochasticInterpolants.EncoderFollmerStochasticInterpolant"><code>StochasticInterpolants.EncoderFollmerStochasticInterpolant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EncoderFollmerStochasticInterpolant(
    unet::UNet,
    sde_sample::Function,
    ode_sample::Function,
    interpolant::Function
)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L259-L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.EncoderFollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer, NamedTuple}" href="#StochasticInterpolants.EncoderFollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, LuxCore.AbstractExplicitLayer, NamedTuple}"><code>StochasticInterpolants.EncoderFollmerStochasticInterpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EncoderFollmerStochasticInterpolant(
    velocity::Lux.AbstractExplicitLayer; 
    interpolant=Interpolant(),
    diffusion_multiplier=0.1f0,
    dev=gpu_device() 
)</code></pre><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L285-L294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.EntropicActionMatching" href="#StochasticInterpolants.EntropicActionMatching"><code>StochasticInterpolants.EntropicActionMatching</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FollmerStochasticInterpolant(
)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L591-L597">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.EntropicActionMatching-Tuple{LuxCore.AbstractExplicitLayer}" href="#StochasticInterpolants.EntropicActionMatching-Tuple{LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.EntropicActionMatching</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EntropicActionMatching(
    velocity::Lux.AbstractExplicitLayer; 
    diffusion_coefficient=DiffusionCoefficient(t -&gt; sqrt.((3f0 .- t) .* (1f0 .- t))),
    projection=nothing,
    dev=gpu_device()
)</code></pre><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L611-L620">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.FollmerStochasticInterpolant" href="#StochasticInterpolants.FollmerStochasticInterpolant"><code>StochasticInterpolants.FollmerStochasticInterpolant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FollmerStochasticInterpolant(
    unet::UNet,
    sde_sample::Function,
    ode_sample::Function,
    interpolant::Function
)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L30-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.FollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer}" href="#StochasticInterpolants.FollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer}"><code>StochasticInterpolants.FollmerStochasticInterpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FollmerStochasticInterpolant(
    velocity::Lux.AbstractExplicitLayer; 
    interpolant=Interpolant(),
    diffusion_multiplier=0.1f0,
    dev=gpu_device() 
)</code></pre><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L57-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.LatentFollmerStochasticInterpolant" href="#StochasticInterpolants.LatentFollmerStochasticInterpolant"><code>StochasticInterpolants.LatentFollmerStochasticInterpolant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LatentFollmerStochasticInterpolant(
    unet::UNet,
    sde_sample::Function,
    ode_sample::Function,
    interpolant::Function
)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L138-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.LatentFollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, VAE_wrapper}" href="#StochasticInterpolants.LatentFollmerStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, VAE_wrapper}"><code>StochasticInterpolants.LatentFollmerStochasticInterpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LatentFollmerStochasticInterpolant(
    velocity::Lux.AbstractExplicitLayer,
    autoencoder::Lux.AbstractExplicitLayer;
    interpolant=Interpolant(),
    diffusion_multiplier=0.1f0,
    dev=gpu_device() 
)</code></pre><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/forecasting_models.jl#L165-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.NoiseScheduling" href="#StochasticInterpolants.NoiseScheduling"><code>StochasticInterpolants.NoiseScheduling</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NoiseScheduling</code></pre><p>A struct to hold the noise scheduling parameters.</p><p>This struct holds the parameters for the noise scheduling process.</p><p><strong>Fields</strong></p><ul><li><code>betas::Vector{T}</code>: The beta values.</li><li><code>alphas::Vector{T}</code>: The alpha values.</li><li><code>alphas_cumprod::Vector{T}</code>: The cumulative product of the alpha values.</li><li><code>alphas_cumprod_prev::Vector{T}</code>: The cumulative product of the alpha values, shifted by one.</li><li><code>sqrt_recip_alphas::Vector{T}</code>: The square root of the reciprocal of the alpha values.</li><li><code>sqrt_alphas_cumprod::Vector{T}</code>: The square root of the cumulative product of the alpha values.</li><li><code>sqrt_one_minus_alphas_cumprod::Vector{T}</code>: The square root of one minus the cumulative product of the alpha values.</li><li><code>posterior_variance::Vector{T}</code>: The posterior variance.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/DDPM/noise_scheduling.jl#L28-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.NormalizePars" href="#StochasticInterpolants.NormalizePars"><code>StochasticInterpolants.NormalizePars</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>NormalizePars(mean, std)</p><p>A container for the normalization and inverse normalization functions. Data is transformed to be between 0 and 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/preprocessing_utils.jl#L76-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.PhysicsInformedStochasticInterpolant" href="#StochasticInterpolants.PhysicsInformedStochasticInterpolant"><code>StochasticInterpolants.PhysicsInformedStochasticInterpolant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhysicsInformedStochasticInterpolant(
    unet::UNet,
    sde_sample::Function,
    ode_sample::Function,
    interpolant::Function
)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/physics_informed_models.jl#L2-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.PhysicsInformedStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, Function}" href="#StochasticInterpolants.PhysicsInformedStochasticInterpolant-Tuple{LuxCore.AbstractExplicitLayer, Function}"><code>StochasticInterpolants.PhysicsInformedStochasticInterpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PhysicsInformedStochasticInterpolant(
    velocity::Lux.AbstractExplicitLayer; 
    interpolant=Interpolant(),
    diffusion_multiplier=0.1f0,
    dev=gpu_device() 
)</code></pre><p>Constructs a Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/physics_informed_models.jl#L29-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.PositionEncoding" href="#StochasticInterpolants.PositionEncoding"><code>StochasticInterpolants.PositionEncoding</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">position_encoding(dim_embedding::Int, max_length::Int=1000)</code></pre><p>Create a position encoding for a transformer model.</p><p>Based on https://liorsinai.github.io/machine-learning/2022/05/18/transformers.html#position-encodings</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L13-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.ScoreMatchingLangevinDynamics" href="#StochasticInterpolants.ScoreMatchingLangevinDynamics"><code>StochasticInterpolants.ScoreMatchingLangevinDynamics</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>ScoreMatchingLangevinDynamics(         image<em>size::Tuple{Int, Int};          in</em>channels::Int = 3,         channels=[32, 64, 96, 128],          block<em>depth=2,         min</em>freq=1.0f0,          max<em>freq=1000.0f0,          embedding</em>dims=32,         eps=1e-5,     )</p><p>Creates a Denoising Diffusion Probabilistic Model (DDPM) with a UNet architecture.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SMLD/models.jl#L99-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.StandardizeData" href="#StochasticInterpolants.StandardizeData"><code>StochasticInterpolants.StandardizeData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StandardizeData(mean, std)</code></pre><p>A container for the standardization and inverse standardization functions. Data is transform to have zero mean and unit variance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/preprocessing_utils.jl#L25-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.StochasticInterpolantModel" href="#StochasticInterpolants.StochasticInterpolantModel"><code>StochasticInterpolants.StochasticInterpolantModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StochasticInterpolant(
    unet::UNet,
    sde_sample::Function,
    ode_sample::Function,
    interpolant::Function
)</code></pre><p>A container layer for the Stochastic Interpolant model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/models.jl#L10-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.StochasticInterpolantModel-Tuple{Tuple{Int64, Int64}}" href="#StochasticInterpolants.StochasticInterpolantModel-Tuple{Tuple{Int64, Int64}}"><code>StochasticInterpolants.StochasticInterpolantModel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StochasticInterpolantModel(
    image_size::Tuple{Int, Int}; 
    in_channels::Int = 3,
    channels=[32, 64, 96, 128], 
    block_depth=2,
    min_freq=1.0f0,
    max_freq=1000.0f0,
    embedding_dims=32,
    num_steps=100,
)

Constructs a Stochastic Interpolant model</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/models.jl#L33-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.ViPosEmbedding" href="#StochasticInterpolants.ViPosEmbedding"><code>StochasticInterpolants.ViPosEmbedding</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViPosEmbedding(embedding_size, number_patches; init = randn32)</code></pre><p>Positional embedding layer used by many vision transformer-like models.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/embeddings.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.CheckpointManager-Tuple{String, String}" href="#StochasticInterpolants.CheckpointManager-Tuple{String, String}"><code>StochasticInterpolants.CheckpointManager</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CheckpointManager(
    test_problem::String,
    model_name::String,
    config::Dict;
    base_folder::String = &quot;trained_models&quot;
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/checkpoint_utils.jl#L121-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.Interpolant" href="#StochasticInterpolants.Interpolant"><code>StochasticInterpolants.Interpolant</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Interpolant(
    alpha, 
    beta, 
    dalpha_dt, 
    dbeta_dt, 
    interpolant, 
    dinterpolant_dt
)</code></pre><p>A struct that contains the functions for the interpolation and its derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/interpolants.jl#L6-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.LinearMultiHeadSelfAttention-Union{Tuple{Int64, Int64}, Tuple{T}} where T" href="#StochasticInterpolants.LinearMultiHeadSelfAttention-Union{Tuple{Int64, Int64}, Tuple{T}} where T"><code>StochasticInterpolants.LinearMultiHeadSelfAttention</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearMultiHeadSelfAttention(in_planes::Int, number_heads::Int; qkv_bias::Bool=false,
    attention_dropout_rate::T=0.0f0, projection_dropout_rate::T=0.0f0)</code></pre><p>Linear Multi-head self-attention layer based on the paper &quot;Efficient Attention: Attention with Linear Complexities&quot;</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L125-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.MultiHeadSelfAttention-Union{Tuple{Int64, Int64}, Tuple{T}} where T" href="#StochasticInterpolants.MultiHeadSelfAttention-Union{Tuple{Int64, Int64}, Tuple{T}} where T"><code>StochasticInterpolants.MultiHeadSelfAttention</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MultiHeadSelfAttention(in_planes::Int, number_heads::Int; qkv_bias::Bool=false,
    attention_dropout_rate::T=0.0f0, projection_dropout_rate::T=0.0f0)</code></pre><p>Multi-head self-attention layer</p><p><strong>Arguments</strong></p><ul><li><code>planes</code>: number of input channels</li><li><code>nheads</code>: number of heads</li><li><code>qkv_bias</code>: whether to use bias in the layer to get the query, key and value</li><li><code>attn_dropout_prob</code>: dropout probability after the self-attention layer</li><li><code>proj_dropout_prob</code>: dropout probability after the projection layer</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L83-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.VisionTransformerEncoder-Tuple{Any, Any, Any}" href="#StochasticInterpolants.VisionTransformerEncoder-Tuple{Any, Any, Any}"><code>StochasticInterpolants.VisionTransformerEncoder</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VisionTransformerEncoder(in_planes, depth, number_heads; mlp_ratio = 4.0f0,
    dropout = 0.0f0)</code></pre><p>Transformer as used in the base ViT architecture.</p><p><strong>Arguments</strong></p><ul><li><code>in_planes</code>: number of input channels</li><li><code>depth</code>: number of attention blocks</li><li><code>number_heads</code>: number of attention heads</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>mlp_ratio</code>: ratio of MLP layers to the number of input channels</li><li><code>dropout_rate</code>: dropout rate</li></ul><p><strong>References</strong></p><p>[1] Dosovitskiy, Alexey, et al. &quot;An image is worth 16x16 words: Transformers for image recognition at scale.&quot; arXiv preprint arXiv:2010.11929 (2020).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L365-L386">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants._fast_chunk-Tuple{Int64, Int64}" href="#StochasticInterpolants._fast_chunk-Tuple{Int64, Int64}"><code>StochasticInterpolants._fast_chunk</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_fast_chunk(x::AbstractArray, ::Val{n}, ::Val{dim})</code></pre><p>Type-stable and faster version of <code>MLUtils.chunk</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants._flatten_spatial-Union{Tuple{AbstractArray{T, 4}}, Tuple{T}} where T" href="#StochasticInterpolants._flatten_spatial-Union{Tuple{AbstractArray{T, 4}}, Tuple{T}} where T"><code>StochasticInterpolants._flatten_spatial</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_flatten_spatial(x::AbstractArray{T, 4})</code></pre><p>Flattens the first 2 dimensions of <code>x</code>, and permutes the remaining dimensions to (2, 1, 3)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.conv_next_block-Tuple{}" href="#StochasticInterpolants.conv_next_block-Tuple{}"><code>StochasticInterpolants.conv_next_block</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conv_next_block(
    in_channels::Int, 
    out_channels::Int,
    multiplier::Int = 1,
    pars_embed_dim::Int = 1,
    imsize::Tuple{Int, Int} = (64, 128)
)</code></pre><p>Create a conv next block with the given number of input and output channels.  The block consists of two convolutional layers with kernel size <code>kernel_size</code>. The first layer has the same number of input and output channels, while the  second layer has the same number of output channels as the block.  The block also includes batch normalization and a skip connection.</p><p>https://arxiv.org/abs/2201.03545</p><p>Based on https://github.com/tum-pbs/autoreg-pde-diffusion/blob/b9b33913b99ede88d9452c5ab470c5d7f5da5c56/src/turbpred/model<em>diffusion</em>blocks.py#L60</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L107-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.conv_next_block_no_pars-Tuple{}" href="#StochasticInterpolants.conv_next_block_no_pars-Tuple{}"><code>StochasticInterpolants.conv_next_block_no_pars</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conv_next_block_no_pars(
    in_channels::Int, 
    out_channels::Int,
    multiplier::Int = 1,
    pars_embed_dim::Int = 1,
    imsize::Tuple{Int, Int} = (64, 128)
)</code></pre><p>Create a conv next block with the given number of input and output channels.  The block consists of two convolutional layers with kernel size <code>kernel_size</code>. The first layer has the same number of input and output channels, while the  second layer has the same number of output channels as the block.  The block also includes batch normalization and a skip connection.</p><p>https://arxiv.org/abs/2201.03545</p><p>Based on https://github.com/tum-pbs/autoreg-pde-diffusion/blob/b9b33913b99ede88d9452c5ab470c5d7f5da5c56/src/turbpred/model<em>diffusion</em>blocks.py#L60</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L19-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.create_checkpoint_directory-Tuple{String, String}" href="#StochasticInterpolants.create_checkpoint_directory-Tuple{String, String}"><code>StochasticInterpolants.create_checkpoint_directory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_checkpoint_directory(
    test_problem::String,
    model_name::String;
    base_folder::String = &quot;trained_models&quot;
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/checkpoint_utils.jl#L6-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.euler_maruyama_sampler" href="#StochasticInterpolants.euler_maruyama_sampler"><code>StochasticInterpolants.euler_maruyama_sampler</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Euler_Maruyama_sampler(
    model::ScoreMatchingLangevinDynamics,
    marginal_probability_std::Function,
    ps::NamedTuple,
    st::NamedTuple,
    rng::AbstractRNG,
    num_samples::Int,
    num_steps::Int,
    eps::Float32,
    dev=gpu_device()
)

Samples from the SMLD model using the Euler-Maruyama method</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SMLD/sampling.jl#L11-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.forward_diffusion_sample" href="#StochasticInterpolants.forward_diffusion_sample"><code>StochasticInterpolants.forward_diffusion_sample</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">forward_diffusion_sample(
    x_0::AbstractArray, 
    t::AbstractArray, 
    rng::AbstractRNG, 
    noise_scheduling::NoiseScheduling, 
    dev=gpu_device()
)</code></pre><p>Samples the forward diffusion process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/DDPM/noise_scheduling.jl#L95-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_beta_schedule-Tuple{Int64}" href="#StochasticInterpolants.get_beta_schedule-Tuple{Int64}"><code>StochasticInterpolants.get_beta_schedule</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>get<em>beta</em>schedule</p><p>Returns a schedule of beta values for the diffusion process.</p><p>Based on https://colab.research.google.com/drive/1sjy9odlSSy0RBVgMTgP7s99NXsqglsUL?usp=sharing#scrollTo=qWw50ui9IZ5q</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/DDPM/noise_scheduling.jl#L7-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_encoder_forecasting_loss" href="#StochasticInterpolants.get_encoder_forecasting_loss"><code>StochasticInterpolants.get_encoder_forecasting_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_forecasting_loss(
    x_0::AbstractArray, 
    x_1::AbstractArray,
    pars::AbstractArray,
    velocity::Lux.AbstractExplicitLayer,
    encoder::Lux.AbstractExplicitLayer,
    interpolant::Function, 
    gamma::Function,
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L267-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_forecasting_from_gaussian_loss" href="#StochasticInterpolants.get_forecasting_from_gaussian_loss"><code>StochasticInterpolants.get_forecasting_from_gaussian_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_forecasting_from_gaussian_loss(
    x_1::AbstractArray,
    x_condition::AbstractArray,
    pars::AbstractArray,
    velocity::Lux.AbstractExplicitLayer,
    interpolant::NamedTuple, 
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L214-L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_forecasting_loss" href="#StochasticInterpolants.get_forecasting_loss"><code>StochasticInterpolants.get_forecasting_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_forecasting_loss(
    x_0::AbstractArray, 
    x_1::AbstractArray,
    pars::AbstractArray,
    velocity::UNet,
    interpolant::Function, 
    gamma::Function,
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L156-L171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_forecasting_loss" href="#StochasticInterpolants.get_forecasting_loss"><code>StochasticInterpolants.get_forecasting_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_forecasting_loss(
    x_0::AbstractArray, 
    x_1::AbstractArray,
    pars::AbstractArray,
    velocity::UNet,
    interpolant::Function, 
    gamma::Function,
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L349-L364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_loss" href="#StochasticInterpolants.get_loss"><code>StochasticInterpolants.get_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_loss(
    x_0::AbstractArray, 
    x_1::AbstractArray,
    t::AbstractArray, 
    velocity::UNet,
    interpolant::Function, 
    gamma::Function,
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L10-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_loss" href="#StochasticInterpolants.get_loss"><code>StochasticInterpolants.get_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_loss(
    x_0::AbstractArray, 
    t::AbstractArray, 
    model::ScoreMatchingLangevinDynamics, 
    marginal_prob_std, 
    eps=1e-5,
    dev=gpu_device()
)</code></pre><p>Computes the loss of the SMLD model</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SMLD/loss.jl#L10-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_loss" href="#StochasticInterpolants.get_loss"><code>StochasticInterpolants.get_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_loss(
    x_0::AbstractArray, 
    x_1::AbstractArray,
    t::AbstractArray, 
    velocity::UNet,
    score::UNet,
    interpolant::Function, 
    gamma::Function,
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L57-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_physics_forecasting_loss" href="#StochasticInterpolants.get_physics_forecasting_loss"><code>StochasticInterpolants.get_physics_forecasting_loss</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_physics_forecasting_loss(
    x_0::AbstractArray, 
    x_1::AbstractArray,
    pars::AbstractArray,
    velocity::UNet,
    interpolant::Function, 
    gamma::Function,
    ps::NamedTuple, 
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Computes the loss for the stochastic interpolant Model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/loss.jl#L454-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.get_t_pars_embedding" href="#StochasticInterpolants.get_t_pars_embedding"><code>StochasticInterpolants.get_t_pars_embedding</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_t_pars_embedding(
    pars_dim,
    with_time,
    embedding_dim,
    min_freq=1.0f0, 
    max_freq=1000.0f0, 
)</code></pre><p>Get the time and parameter embedding layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/embeddings.jl#L81-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.load_model_config-Tuple{String}" href="#StochasticInterpolants.load_model_config-Tuple{String}"><code>StochasticInterpolants.load_model_config</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_model_config(path::String)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/checkpoint_utils.jl#L85-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.load_model_weights-Tuple{String}" href="#StochasticInterpolants.load_model_weights-Tuple{String}"><code>StochasticInterpolants.load_model_weights</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_model_weights(path::String)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/checkpoint_utils.jl#L69-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.multiple_conv_next_blocks-Tuple{}" href="#StochasticInterpolants.multiple_conv_next_blocks-Tuple{}"><code>StochasticInterpolants.multiple_conv_next_blocks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multiple_conv_next_blocks(
    in_channels::Int, 
    out_channels::Int,
    multiplier::Int = 1,
    embedding_dims::Int = 1,
    imsize::Tuple{Int, Int} = (64, 128)
)</code></pre><p>Create a chain of two conv next blocks with the given number of input and output channels. The first block has the same number of input and output</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L164-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.multiple_conv_next_blocks_no_pars-Tuple{}" href="#StochasticInterpolants.multiple_conv_next_blocks_no_pars-Tuple{}"><code>StochasticInterpolants.multiple_conv_next_blocks_no_pars</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">multiple_conv_next_blocks_no_pars(
    in_channels::Int, 
    out_channels::Int,
    multiplier::Int = 1,
    padding=&quot;constant&quot;
)</code></pre><p>Create a chain of two conv next blocks with the given number of input and output channels. The first block has the same number of input and output</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/conv_next.jl#L68-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.parameter_diffusion_transformer_block-Tuple{}" href="#StochasticInterpolants.parameter_diffusion_transformer_block-Tuple{}"><code>StochasticInterpolants.parameter_diffusion_transformer_block</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parameter_diffusion_transformer_block(
    in_channels::Int,
    out_channels::Int,
    pars_dim::Int,
    embed_dim::Int,
    number_heads::Int,
    mlp_ratio::Int,
    imsize::Tuple{Int, Int},
    patch_size::Int,
    number_patches::Int
)</code></pre><p>Create a parameter diffusion transformer block with the given number of input and output channels, parameter dimensions, embedding dimensions, number of heads, MLP ratio, image size, patch size, and number of patches.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/diffusion_transformer.jl#L170-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.patchify-Tuple{Tuple{Int64, Int64}}" href="#StochasticInterpolants.patchify-Tuple{Tuple{Int64, Int64}}"><code>StochasticInterpolants.patchify</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">patchify(
    imsize::Tuple{Int, Int}=(64, 64),
    in_channels::Int=3,
    patch_size::Tuple{Int, Int}=(8, 8),
    embed_planes::Int=128,
    norm_layer=Returns(Lux.NoOpLayer()),
    flatten=true
)</code></pre><p>Create a patch embedding layer with the given image size, number of input channels, patch size, embedding planes, normalization layer, and flatten flag.</p><p>Based on https://github.com/LuxDL/Boltz.jl/blob/v0.3.9/src/vision/vit.jl#L48-L61</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L263-L277">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.sample_timestep-Tuple{AbstractArray, AbstractArray}" href="#StochasticInterpolants.sample_timestep-Tuple{AbstractArray, AbstractArray}"><code>StochasticInterpolants.sample_timestep</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample_timestep(
    x::AbstractArray, 
    t::AbstractArray;
    model,
    noise_scheduling::NoiseScheduling,
    ps::NamedTuple,
    st::NamedTuple,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Calls the model to predict the noise in the image and returns  the denoised image.  Applies noise to this image, if we are not in the last step yet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/DDPM/sampling.jl#L11-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.save_checkpoint-Tuple{}" href="#StochasticInterpolants.save_checkpoint-Tuple{}"><code>StochasticInterpolants.save_checkpoint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_checkpoint(ps, st, opt_st, output_dir, epoch)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/checkpoint_utils.jl#L31-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.sinusoidal_embedding" href="#StochasticInterpolants.sinusoidal_embedding"><code>StochasticInterpolants.sinusoidal_embedding</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sinusoidal_embedding(
    x::AbstractArray{AbstractFloat, 4},
    min_freq::AbstractFloat,
    max_freq::AbstractFloat,
    embedding_dims::Int
)</code></pre><p>Embed the noise variances to a sinusoidal embedding with the given frequency range and embedding dimensions.</p><p>Based on https://yng87.page/en/blog/2022/lux-ddim/.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/embeddings.jl#L13-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.train_diffusion_model" href="#StochasticInterpolants.train_diffusion_model"><code>StochasticInterpolants.train_diffusion_model</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_diffusion_model(
    model,
    ps::NamedTuple,
    st::NamedTuple,
    opt_state::NamedTuple,
    trainset::AbstractArray,
    num_epochs::Int,
    batch_size::Int,
    num_samples::Int,
    rng::AbstractRNG,
    dev=gpu_device()
)</code></pre><p>Train the Diffusion model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/training.jl#L18-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.train_stochastic_interpolant" href="#StochasticInterpolants.train_stochastic_interpolant"><code>StochasticInterpolants.train_stochastic_interpolant</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_stochastic_interpolant(
    model::StochasticInterpolantModel,
    ps::NamedTuple,
    st::NamedTuple,
    opt_state::NamedTuple,
    trainset::AbstractArray,
    num_epochs::Int,
    batch_size::Int,
    num_samples::Int,
    rng::AbstractRNG,
    trainset_init_distribution::AbstractArray=nothing,
    init_and_target_are_correlated=false,
    train_time_stepping=false,
    dev=gpu_device()
)</code></pre><p>Train the Stochastic Interpolant model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/training.jl#L121-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.train_stochastic_interpolant-Tuple{}" href="#StochasticInterpolants.train_stochastic_interpolant-Tuple{}"><code>StochasticInterpolants.train_stochastic_interpolant</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_stochastic_interpolant(
    model,
    ps::NamedTuple,
    st::NamedTuple,
    opt_state::NamedTuple,
    trainset::AbstractArray,
    num_epochs::Int,
    batch_size::Int,
    num_samples::Int,
    rng::AbstractRNG,
    trainset_init_distribution::AbstractArray=nothing,
    init_and_target_are_correlated=false,
    train_time_stepping=false,
    dev=gpu_device()
)</code></pre><p>Train the Stochastic Interpolant model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/training.jl#L25-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.train_stochastic_interpolant_for_closure-Tuple{}" href="#StochasticInterpolants.train_stochastic_interpolant_for_closure-Tuple{}"><code>StochasticInterpolants.train_stochastic_interpolant_for_closure</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_stochastic_interpolant_for_closure(
    model,
    ps::NamedTuple,
    st::NamedTuple,
    opt_state::NamedTuple,
    trainset::AbstractArray,
    num_epochs::Int,
    batch_size::Int,
    num_samples::Int,
    rng::AbstractRNG,
    trainset_init_distribution::AbstractArray=nothing,
    init_and_target_are_correlated=false,
    train_time_stepping=false,
    dev=gpu_device()
)</code></pre><p>Train the Stochastic Interpolant model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/SI/training.jl#L196-L214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="StochasticInterpolants.unpatchify-NTuple{4, Any}" href="#StochasticInterpolants.unpatchify-NTuple{4, Any}"><code>StochasticInterpolants.unpatchify</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unpatchify(x, patch_size, out_channels)</code></pre><p>Unpatchify the input tensor <code>x</code> with the given patch size and number of output channels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nmucke/StochasticInterpolants.jl/blob/cf04f6f04e2c12e58d5c0c4340d36b6924552cc9/src/neural_network_layers/transformer.jl#L299-L304">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 7 January 2025 08:31">Tuesday 7 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
